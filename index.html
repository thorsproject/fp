<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<!---------- Debug-Option ----------> 
<script>
  window.addEventListener("error", (e) => {
    alert("JS ERROR:\n" + (e.message || e.error) + "\n" + (e.filename || "") + ":" + (e.lineno || ""));
  });
  window.addEventListener("unhandledrejection", (e) => {
    alert("PROMISE ERROR:\n" + (e.reason?.message || e.reason));
  });
</script>
<!---------- Debug-Option Ende----------> 

<!-- PWA -->
<link rel="manifest" href="manifest.json">

<meta name="theme-color" content="#1b1f24">

<!-- iOS Support -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Flight Planning">

<link rel="apple-touch-icon" href="icon-192.png">

<title>Flight Planning V0.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Link zum CSS -->
<link rel="stylesheet" href="css/style.css?v=1">
<!-- Link zum Java Script -->
<script type="module" src="js/app.js?v=1"></script>

</head>
<body>

<header class="topbar">
  <div class="topbar-title">FLIGHT PLANNING V0.1</div>
  <!-- BUTTON TOPNAV -->
<nav class="topbar-nav" id="topnav">
  <button class="topbtn active" data-view="view-map" type="button">MAP</button>
  <button class="topbtn" data-view="view-checklist" type="button">Checklist</button>
  <button class="topbtn" data-view="view-fuel" type="button">FUEL Planning</button>
  <button class="topbtn" data-view="view-perfo" type="button">PERFORMANCE</button>
  <button class="topbtn" data-view="iew-settings" type="button">Settings</button>
  <button class="topbtn" data-view="view-orm" type="button">ORM öffnen</button>
  <button class="topbtn" data-view="view-mail" type="button">Mail EO senden</button>
</nav>
</header>

<div class="views">
  <!-- VIEW: Route + Map -->
  <section id="view-route" class="view is-active">
  <div class="layout">
    <!-- LINKS: Route immer sichtbar -->
    <aside class="route-panel">
      <div class="left-panel">
        <!-- FRAME 1 -->
        <div class="frame">
          <div class="master-grid">
            <!-- Zeile 1 -->
            <div></div> <!-- Spalte 1 leer -->
            <div class="label">DATE</div> <!-- Spalte 2 -->
            <div><input type="text" id="dateInput" maxlength="8" placeholder="TT.MM.JJ"></div> <!-- Spalte 3 -->
            <div class="label aero-label">FDL</div> <!-- Spalte 4 -->
            <div><input type="text" id="FDLinput"></div> <!-- Spalte 5 -->
            <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 2 -->
            <div></div> <!-- Spalte 1 leer -->
            <div class="label">LFZ</div> <!-- Spalte 2 -->
            <div><select id="lfzSelect"></select></div> <!-- Spalte 3 -->
            <div class="label aero-label">TEL:</div> <!-- Spalte 4 -->
            <div><input type="text" id="TELinput"></div> <!-- Spalte 5 -->
            <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 3 -->
            <div></div> <!-- Spalte 1 leer -->
            <div class="label">CALL SIGN</div> <!-- Spalte 2 -->
            <div id="callSignDisplay" class="callSignDisplay"></div> <!-- Spalte 3: Anzeige CALL SIGN -->
            <div class="label aero-label">TAC-CS</div> <!-- Spalte 4 -->
            <div><select id="tacSelect"></select></div> <!-- Spalte 5 -->
            <div></div> <!-- Spalte 6 leer -->
          </div>
        </div>

        <!-- FRAME 2-5 - LEGS -->
        <div id="legsContainer">

          <!-- Leg 1 -->
          <div class="frame">
            <div class="master-grid">

            <!-- Zeile 1 -->
              <div class="label leg-title" style="grid-row:1/4;">LEG 1</div> <!-- Spalte 1 -->
              <div class="label">ETD</div> <!-- Spalte 2 -->
              <input type="text" class="time legField etd"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroFrom"> <!-- Spalte 5 -->
        <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 2 -->
              <div class="label">ETA</div> <!-- Spalte 2 -->
              <input type="text" class="time legField eta"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroTo"> <!-- Spalte 5 -->
        <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 3 -->
              <div class="label">ALTERNATE</div> <!-- Spalte 2 -->
        <div></div> <!-- Spalte 3 leer -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="alt legField"> <!-- Spalte 5 -->
              <input type="text" class="alt legField col6"> <!-- Spalte 6 -->
            </div>
          </div>

          <!-- Leg 2 -->
          <div class="frame">
            <div class="master-grid">

            <!-- Zeile 1 -->
              <div class="label leg-title" style="grid-row:1/4;">LEG 2</div> <!-- Spalte 1 -->
              <div class="label">ETD</div> <!-- Spalte 2 -->
              <input type="text" class="time legField etd"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroFrom"> <!-- Spalte 5 -->
              <button class="legToggle col6" data-leg="2" data-state="active">ACTIVE</button> <!-- Spalte 6 -->

            <!-- Zeile 2 -->
              <div class="label">ETA</div> <!-- Spalte 2 -->
              <input type="text" class="time legField eta"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroTo"> <!-- Spalte 5 -->
        <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 3 -->
              <div class="label">ALTERNATE</div> <!-- Spalte 2 -->
        <div></div> <!-- Spalte 3 leer -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="alt legField"> <!-- Spalte 5 -->
              <input type="text" class="alt legField col6"> <!-- Spalte 6 -->
            </div>
          </div>

          <!-- Leg 3 -->
          <div class="frame">
            <div class="master-grid">

            <!-- Zeile 1 -->
              <div class="label leg-title" style="grid-row:1/4;">LEG 3</div> <!-- Spalte 1 -->
              <div class="label">ETD</div> <!-- Spalte 2 -->
              <input type="text" class="time legField etd"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroFrom"> <!-- Spalte 5 -->
              <button class="legToggle col6" data-leg="3" data-state="active">ACTIVE</button> <!-- Spalte 6 -->


            <!-- Zeile 2 -->
              <div class="label">ETA</div> <!-- Spalte 2 -->
              <input type="text" class="time legField eta"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroTo"> <!-- Spalte 5 -->
        <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 3 -->
              <div class="label">ALTERNATE</div> <!-- Spalte 2 -->
        <div></div> <!-- Spalte 3 leer -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="alt legField"> <!-- Spalte 5 -->
              <input type="text" class="alt legField col6"> <!-- Spalte 6 -->
            </div>
          </div>

          <!-- Leg 4 -->
          <div class="frame">
            <div class="master-grid">

            <!-- Zeile 1 -->
              <div class="label leg-title" style="grid-row:1/4;">LEG 4</div> <!-- Spalte 1 -->
              <div class="label">ETD</div> <!-- Spalte 2 -->
              <input type="text" class="time legField etd"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroFrom"> <!-- Spalte 5 -->
              <button class="legToggle col6" data-leg="4" data-state="active">ACTIVE</button> <!-- Spalte 6 -->

            <!-- Zeile 2 -->
              <div class="label">ETA</div> <!-- Spalte 2 -->
              <input type="text" class="time legField eta"> <!-- Spalte 3 -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="aero legField aeroTo"> <!-- Spalte 5 -->
        <div></div> <!-- Spalte 6 leer -->

            <!-- Zeile 3 -->
              <div class="label">ALTERNATE</div> <!-- Spalte 2 -->
        <div></div> <!-- Spalte 3 leer -->
              <div class="label aero-label">AERODROME</div> <!-- Spalte 4 -->
              <input type="text" class="alt legField"> <!-- Spalte 5 -->
              <input type="text" class="alt legField col6"> <!-- Spalte 6 -->
            </div>
          </div>

        <!-- BUTTON BOTTOM PANEL -->
        <div class="frame">
          <div class="routebtn">
            <button class="routebtnReset">Reset ETD/ETA</button>
            <button class="routebtnReset">Reset AERODROMES</button>
          </div>
        </div>
      </div>

      <datalist id="airfieldsList"></datalist>
      <datalist id="alternatesList"></datalist>

    </aside>

    <!-- RECHTS: wechselnder Content -->
    <main class="content-panel">

      <!-- VIEW: MAP -->
      <section id="view-map" class="view is-active">
         <div class="map-controls">
          <div class="ctrl-chip">
            <span>Weather</span>
            <button id="toggleWeather" type="button">OFF</button>
          </div>

          <div class="ctrl-chip">
            <span>Wind</span>
            <button id="toggleWind" type="button">OFF</button>
          </div>

          <div class="ctrl-chip">
            <span>Level</span>
            <select id="windLevelSelect">
              <option value="SFC">SFC</option>
              <option value="25">FL025</option>
              <option value="50">FL050</option>
              <option value="80">FL080</option>
              <option value="100">FL100</option>
              <option value="180">FL180</option>
            </select>
          </div>
        </div>
        <div class="map-frame" id="map"></div>
      </section>

      <!-- VIEW: CHECKLIST -->
      <section id="view-checklist" class="view">
        <div class="frame">
          <h2 class="view-title">Checklist</h2>
          <p class="view-sub">Platzhalter – hier kommt deine Checklist rein.</p>
        </div>
      </section>

      <!-- VIEW: FUEL -->
      <section id="view-fuel" class="view">
        <div class="fuel-wrap frame">

          <div class="fuel-sheet">
            <div class="fuel-header">FUEL PLANNING</div>

            <div class="fuel-grid">
              <!-- linke Tabelle -->
              <div class="fuel-table">

                <div class="fuel-row fuel-head">
                  <div class="c-desc"></div>
                  <div class="c-leg">Leg 1</div>
                  <div class="c-leg">Leg 2</div>
                  <div class="c-leg">Leg 3</div>
                  <div class="c-leg">Leg 4</div>
                  <div class="c-usg">USG</div>
                  <div class="c-time">Zeit</div>
                </div>

                <!-- Trip Fuel NC -->
                <div class="fuel-row">
                  <div class="c-desc">Trip Fuel NC</div>
                  <div class="c-leg"><input class="fuel-in" data-field="trip_leg1" /></div>
                  <div class="c-leg"><input class="fuel-in" data-field="trip_leg2" /></div>
                  <div class="c-leg"><input class="fuel-in" data-field="trip_leg3" /></div>
                  <div class="c-leg"><input class="fuel-in" data-field="trip_leg4" /></div>
                  <div class="c-usg"><div class="fuel-out" data-out="trip_usg">0,0</div></div>
                  <div class="c-time"><div class="fuel-out" data-out="trip_time">00:00</div></div>
                </div>

                <!-- Company Fuel -->
                <div class="fuel-row">
                  <div class="c-desc">Company Fuel</div>
                  <div class="c-leg"></div>
                  <div class="c-leg"></div>
                  <div class="c-leg"></div>
                  <input data-field="appr_ifr_n" inputmode="numeric" />
                  <input data-field="appr_vfr_n" inputmode="numeric" />
                  <span data-out="company_usg"></span>
                  <span data-out="company_time"></span>
                </div>

                <!-- Contingency Fuel -->
                <div class="fuel-row">
                  <div class="c-desc">Contingency Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out" data-out="cont_usg">0,0</div></div>
                  <div class="c-time"><div class="fuel-out fuel-black" data-out="cont_time"></div></div>
                </div>

                <!-- Alternate Fuel NC -->
                <div class="fuel-row">
                  <div class="c-desc">Alternate Fuel NC</div>
                  <div class="c-leg"><input class="fuel-in" data-field="alt_leg1" /></div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out" data-out="alt_usg">0,0</div></div>
                  <div class="c-time"><div class="fuel-out" data-out="alt_time">00:00</div></div>
                </div>

                <!-- Additional Fuel MEC -->
                <div class="fuel-row">
                  <div class="c-desc">Additional Fuel MEC</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out fuel-black" data-out="add_usg"></div></div>
                  <div class="c-time"><div class="fuel-out fuel-black" data-out="add_time"></div></div>
                </div>

                <!-- Final Reserve Fuel MEC -->
                <div class="fuel-row">
                  <div class="c-desc">Final Reserve Fuel MEC</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out" data-out="fr_usg">0,0</div></div>
                  <div class="c-time"><div class="fuel-out" data-out="fr_time">00:00</div></div>
                </div>

                <!-- Planned Takeoff Fuel -->
                <div class="fuel-row fuel-boldline">
                  <div class="c-desc fuel-bold">Planned Takeoff Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg fuel-bold"><div class="fuel-out" data-out="pto_usg">0,0</div></div>
                  <div class="c-time fuel-bold"><div class="fuel-out" data-out="pto_time">00:00</div></div>
                </div>

                <!-- Extra Fuel LRC -->
                <div class="fuel-row">
                  <div class="c-desc">Extra Fuel LRC</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out" data-out="lrc_usg">0,0</div></div>
                  <div class="c-time"><div class="fuel-out" data-out="lrc_time">00:00</div></div>
                </div>

                <!-- Takeoff Fuel -->
                <div class="fuel-row fuel-boldline">
                  <div class="c-desc fuel-bold">Takeoff Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg fuel-bold"><div class="fuel-out" data-out="to_usg">0,0</div></div>
                  <div class="c-time fuel-bold"><div class="fuel-out" data-out="to_time">00:00</div></div>
                </div>

                <!-- Taxi Fuel / Block Fuel / Landing Fuel etc. (als Platzhalter) -->
                <div class="fuel-row">
                  <div class="c-desc">Taxi Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><input class="fuel-in" data-field="taxi_usg" /></div>
                  <div class="c-time"></div>
                </div>

                <div class="fuel-row">
                  <div class="c-desc">Block Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg"><div class="fuel-out" data-out="block_usg">0,0</div></div>
                  <div class="c-time"></div>
                </div>

                <div class="fuel-row fuel-boldline">
                  <div class="c-desc fuel-bold">Landing Fuel</div>
                  <div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div><div class="c-leg"></div>
                  <div class="c-usg fuel-bold"><div class="fuel-out" data-out="land_usg">0,0</div></div>
                  <div class="c-time fuel-bold"><div class="fuel-out" data-out="land_time">00:00</div></div>
                </div>

                <!-- Mini-Box unten links -->
                <div class="fuel-mini">
                  <div class="mini-row"><div>Bingo Fuel</div><div class="mini-val" data-out="bingo">0</div></div>
                  <div class="mini-row"><div>Min Block Fuel</div><div class="mini-val" data-out="minblock">0,0</div></div>
                  <div class="mini-row"><div>CO2 Fußabdruck</div><div class="mini-val" data-out="co2">0,00 KGS</div></div>
                </div>
              </div>

              <!-- rechte Side Notes -->
              <div class="fuel-notes">
                <div class="note-line">Extra Approaches IFR</div>
                <div class="note-line">Extra Approaches VFR</div>

                <div class="note-gap"></div>

                <div class="note-line">+ 2 USG gem. RPA-Differences</div>
                <div class="note-line">gem. TBH nicht erlaubt</div>

                <div class="note-box">
                  <div>Standard= Main: 44 / Aux: 26,4 USG</div>
                  <div>Standard Block Fuel:</div>
                  <div class="note-inputs">
                    <button id="fuelStdBlockYes" type="button" class="fuel-smallbtn">JA</button>
                    <div class="note-val" data-out="auxFuel">26,4</div>
                  </div>
                </div>
              </div>
            </div>

          </div>

          <!-- Buttonleiste unten -->
          <div class="fuel-actions">
            <button class="route-action-btn" id="fuelClearAll" type="button">alle Eingabezellen leeren</button>
            <button class="route-action-btn" id="fuelClearFuel" type="button">Eingabezellen FUEL leeren</button>
            <button class="route-action-btn" id="fuelClearHead" type="button">Eingabezellen KOPF leeren</button>
            <button class="route-action-btn" id="fuelEditFixed" type="button">Fixwerte bearbeiten</button>
          </div>

        </div>
      </section>

      <!-- VIEW: PERFORMANCE -->
      <section id="view-performance" class="view">
        <div class="frame">
          <h2 class="view-title">Performance</h2>
          <p class="view-sub">Platzhalter – hier kommt Performance rein.</p>
        </div>
      </section>

      <!-- VIEW: SETTINGS -->
      <section id="view-settings" class="view">
        <div class="frame">
          <h2 class="view-title">Settings</h2>
          <p class="view-sub">Platzhalter – hier kommen Settings rein.</p>
        </div>
      </section>

    </main>
  </div>
</div>

</body>
</html>
